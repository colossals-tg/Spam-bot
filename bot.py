# join @PythonPortalz for more tools
from telethon import TelegramClient, events
from telethon.tl.types import InputPeerUser
import asyncio
import random
import time
from typing import Dict, Optional
from dataclasses import dataclass
import os

SPAM_MESSAGES = {
    "hindi": [
    "Janta dukhi hai modi se, teri mummy ko uthne nahi dunga aaj apni godi se",
    "Lund loge lund┬┐?",
    "рд╡рд┐рд░рд╛рдЯ рдХреЛрд╣рд▓реА рдХреЗ рдмрд▓реНрд▓реЗ рдХрд╛ рд╢реЙрдЯ рдФрд░ рддреЗрд░реА рдордореНрдореА рдХрд╛ рдкреЗрдЯреАрдХреЛрдЯ, рджреЛрдиреЛрдВ рдПрдХ Time рдкрд░ рдКрдкрд░ рдЙрдарддреЗ рд╣реА рд╣реИрдВ",
    "рдЧреЛрднреА рдкреНрдпрд╛рдЬ рднрд┐рдВрдбреА рдЖрд▓реВ, рдХреНрдпрд╛ рддреЗрд░реА рдмрд╣рди рдХреЛ рдореИрдВ рдкрдЯрд╛рд▓реВрдВ┬┐?",
    "рддреЗрд░реА рдордореНрдореА рдиреЗ last time рдЕрдкрдиреА рдЭрд╛рдЯреЗ рдХрдм рдХрд╛рдЯреА рдереА...?ЁЯдЧ",
    "рдкреНрд░рд╢рд╛рдВрдд рдорд╣рд╛рд╕рд╛рдЧрд░ рдХреА рдЧрд╣рд░рд╛рдЗрдпреЛрдВ рдореЗрдВ рд▓реЗрдЬрд╛рдХрд░ рддреЗрд░реА рджреАрджреА рдХреЛ рдЪреЛ*рдж рджреВрдВрдЧрд╛",
    "There's a word called WHORE, Your Mom Owns it",
    "1+1=3 (рдХреНрдпреЛрдВрдХрд┐ рддреЗрд░реА рдордореНрдореА рдХреЛ рдмрд┐рди condom рдХреЗ рдЪреЛ*рдж рджрд┐рдпрд╛ рдерд╛ рдореИрдВ)",
    "Teri mummy ko tajmahal ki рдиреЛрдХ par bitha dunga",
    "Agar 1 se pehle 0 aata hai, to A se pehle cya aayega┬┐?",
    "Teri budhiya dadi mere bathroom me fisal gyi",
    "Teri mummy ko 73рд╡реАрдВ hoor bana dunga rndike",
    "jannat me jaakr teri pardadi ko chod dunga",
    "Teri mummy ke muh pr apne lund se knock knock kr dunga",
    "Ek hota hai chutiya ek hota hai maha chutiya or teesra main hu jisne bina condom ke teri mummy chodne ki galti kr di",
    "Aadat se рд▓рдЪрд╛рд░ hu, teri mummy ka purana рднрддрд╛рд░ hu",
    "Kati patang tera kon sa rang... Jis rang ki teri behan ne panty pehni hogi wo wala rang",
    "Teri behan ki chut me рдЪрд╛рдХреВ ЁЯФк se fingering kar dunga abb",
    "рдЪреБрдк рдЧрд░реАрдмреА рд░реЗрдЦрд╛ рдореЗрдВ рд░реЗрдВрдЧрдиреЗ рд╡рд╛рд▓реЗ рдХреАрдбрд╝реЗЁЯдлЁЯе▒",
    "muh band rakh napunsak ki awlaad",
    "Fruti ya pepsi, teri behan badi sexy",
    "Teri behan ka insta id milega cyaЁЯШИЁЯШЙ┬┐?",
    "рддреВ рдЕрдкрдиреА рдмрд╣рди рдХреЛ рдмреЛрд▓ рди рдореБрдЭреЗ рдЕрдкрдиреЗ рдЬрд╛рдВрдШреЛрдВ рдХреЗ рдмреАрдЪ рджрдмрд╛ рдХрд░ рдорд╛рд░ рджреЗЁЯЩИ",
    "Koi hota hai pagal, to koi banata hai khayali pulau, cya main teri didi ke boobs dabau?",
    "Sarkari school ke peeche lejakr teri didi ki salwar ka nada khol dunga",
    "Gali gali me rehta hai saand, teri mummy ko itna choda ki wo ban gyi RaandЁЯШБ",
    "Teri maa 150 wali randi",
    "Jungle me naachta hai Morr, teri mummy ki chudayi dekhkar sb bolte hn once more once more",
    "Teri behan ki chut me kutte ka sperm",
    "Teri behan ki yaado me jee rha hu ab bss",
    "Teri mummy ki flipcart se order kar lunga",
    "Duniya paise laha rahi ghode pe, or teri mummy ghum fir kar aa jaati hai mere ЁЯднЁЯШИ",
    "Teri mummy ko itna chodunga ki usko рд▓рдХрд╡рд╛ maar jayega",
    "Bura mat maniyo teri mummy ni chod sakta, apni wali ke liye loyal hu",
    "teri behan ki gand me top chala dunga",
    "Teri mummy ko momos khilakr chod dunga",
    "Move Theatre me teri behan ki panty me hath daal dunga",
    "kaise chudi teri maa┬┐?",
    "рдЪреБрджрд▓реЗ рдлреЗрд░ЁЯдЧЁЯдл",
    "Chudayi kar du aapni mummy ki??",
    "Teri behan ko geela kar diya maine",
    "Mere sexting se to tere ghar ki saari aurte khush hai",
    "Ronaldo ka football teri mummy ki gand ke chhed me ghusa dunga",
    "рдЕрдВрдзреЗрд░реЗ рдореЗрдВ rehne wala рднреВрдд рдФрд░ рддреЗрд░реА рдордореНрдореА рдХреА рдХрд╛рд▓реА рдЪреВрдд, рджреЛрдиреЛрдВ useless hai",
    "рдпреЗ рдЧрд░рдЬрдиреЗ рд╡рд╛рд▓реЗ рдмрд╛рджрд▓ рд╣реИ рдирд╛ ! рд╢реЗрд░ рджрд╣рд╛рдбрд╝рдиреЗ wala рдШрд╛рдпрд▓ рд╣реИ рдирд╛ !! рдФрд░ рдХрд╣рддреА рд╣реИ рдореЗрд░реЗ рд▓рдВрдб рдкреЗ рдореВрддреЗрдЧреА, рддреЗрд░реА рдордореНрдореА рднреА рдХрд┐рддрдиреА рдкрд╛рдЧрд▓ рд╣реИ рдирд╛ ",
    "рдмрдЪреНрдЪреЗ рд░реЛрддреЗ рд╣реИрдВ рдорд┐рдард╛рдИ рдХреЗ рд▓рд┐рдП, рдФрд░ рддреЗрд░реА рдордореНрдореА рдХреЗ рдореБрдВрд╣ рдореЗрдВ рдкрд╛рдиреА рдЖрддрд╛ рд╣реИ рдореЗрд░реЗ рд▓рдВрдб wale рдорд▓рд╛рдИ рдХреЗ рд▓рд┐рдП",
    "Teri behan ki chut me thanos ka glub",
    "Spiderman ki tarah diwar par latak kar teri mummy ki gand maar lunga",
    "Teri mummy ko superman wali laal chaddi pehna dunga",
    "Maine to sapne bhi teri behan ko chodne wale dekhe hn",
    "Shatap mere bete",
    "Aand bhaat khayega┬┐?",
    "teri mummy ko apna lwda-paaw khilata hu ruk",
    "Teri mummy ke 2 kaam~ pehla mere lund par baithkar mootna or dusra fir usi lund ko chusna",
    "Teri mummy ko bulu bulu kar du kyaЁЯе║ЁЯлг┬┐?",
    "tu apni behan ko meri godi me bitha de",
    "Teri maa chod di, teri behan pel daali, ab aayi teri nani ki baari",
    "teri mummy ki chut me Sidha lund se shot marunga to tera bhai hoga, Aada-Tedha shot maarunga to teri behan hogi, bata tujhe kyw chahiye",
    "Ter behan ko hentai dikha dunga",
    "Teri didi ke boobs chaba jaungaЁЯлж",
    "Teri behan ki gori chut hai ya kaali┬┐?",
    "Teri mummy meri gulam",
    "Teri behan ki chut pe vimal thuk diya kisi ne┬┐?",
    "Abe tere or teri mummy ke jaiso ko lund par jhula du",
    "chup madarchod",
    "Jana lwde teri mummy ko chudne se bacha",
    "Teri behan ki pet me mera bachha",
    "Teri randi maa ko kitno ne choda┬┐?",
    "Teri mummy ke muh se apna zip khulwa lunga",
    "Teri behan bhi teri mummy ki tarah randi nikal gyi",
    "Teri mummy ko apne lund se jhula jhulwa dunga",
    "Tujhe, teri mummy ko, tere bane banaye ghar ke sath khareed lunga gareeb",
    "Teri didi ke sath sexting kr dunga",
    "Chut ka diwana main teri mummy ki chut ka diwana",
    "Your mom, My bitch, Otey┬┐?",
    "Teri mummy ki brownish chut pe apna paani giraunga",
    "Hawe hawe me teri mummy ko рдЙрдЫрд╛рд▓рддреЗ hue chod dunga",
    "Teri mummy ke sath lawandiyabaazi karu randi ke",
    "Teri mummy ki fati choot apne jhaato se seel dunga",
    "chup chudi hui raand ke bette",
    "Or bete kya haal",
    "Teri mummy ki chut me pura laat ghusa dunga",
    "Teri behan meri khelne wali gudiya ok?",
    "Teri behan ki teady bear dilakr chod dunga",
    "Teri didi ka WhatsApp number milega cya┬┐?",
    "Teri behan ke noods de to dekhkr delete kar dungaтШая╕ПЁЯЩИ",
    "Just Imagine ki teri mummy ki gand me agar hathi ka lund chala jaaye toтШая╕ПЁЯШн",
    "Teri mummy mere ghar me kam karne wali baai",
    "Teri mummy ko sexually harass kar dungaЁЯШИЁЯСНЁЯП╗",
    "Teri mummy ko promise kiya hu ki use aaj bikni gift karunga",
    "Teri behan ki chut me captain america ka shield",
    "Teri behan kidnap ho gayi",
    "kutte ke muh me ghee or tu mera lund pee randike",
    "Andhere me teri didi chodkr bhaag jaunga",
    "Apni maa chuda lwde",
    "TERI MA CHUDD JAYEHI BCHEE MOCHI KE",
    "ЁЭРВЁЭРП ЁЭРКЁЭРАЁЭРСЁЭРДЁЭРЖЁЭРА ЁЭРУЁЭРДЁЭРСЁЭРИ ЁЭРМЁЭРА. ЁЭРМЁЭРАЁЭРСЁЭРЙЁЭРАЁЭРШЁЭРА ЁЭРЖЁЭРИ ЁЭРЖЁЭРАЁЭРСЁЭРДЁЭРДЁЭРБЁЭРВЁЭРШЁЭРА ЁЭРМЁЭРА?",
    "OYE JHAATU ЁЯШТ LE YE SUN ЁЯСЗЁЯСЗтЦ╢я╕О тАвсБКсБКсБК|сБЛ||сБЛтАМтАМтАМтАМтАМсБК|тАв 0:10________NHII CHLIII ЁЯе▓",
    "Ek chatt pe 7 kabootarЁЯХКя╕П Saato kha gyi billi ЁЯРИтАНтмЫЁЯШа Teri mmy pair uthye Chomde puri Delhi ЁЯСДЁЯШИ",
    "рдРрд╕реЗ рддреЗрд░реА рдЪреБрджрд╛рдИ nhi rukegi",
    "рддреЗрд░реЗ рдорд╛рдИ рдХреЗ рдЪреВрдд рдореИрдВ резрежреж рд╣рдЯреАрдУ рдХрд╛ рд▓рдВрдб ЁЯдк",
    "рдирд╛ рдкрд░рдЪреЙ рд▓рдЧрддрд╛ рд╣реИ рдирд╛ рдЦрд░реНрдЪрд╛ рд▓рдЧрддрд╛ рд╣реИ рддреЗрд░реА рдорд╛рдБ рдХреЛ рдЬрдм рдорд░реНрдЬрд╝реА рдЪреЛрджреВ рдЕрдЪреНрдЫрд╛ рд▓рдЧрддрд╛ hai.",
    "Teryma ki shut pe рдкреНрд░рд╣рд╛рд░ kru apne рд▓реБрдВрдб se тШая╕ПЁЯТетШая╕ПЁЯТе",
    "7 рд░рдВрдЧ рдХреЗ 7 рдХрдмреВрддрд░ рд╕рд╛рддреЛрдВ  рдЦрд╛ рдЧрдИ рдмрд┐рд▓реНрд▓реА рддреЗрд░реА рдордореНрдореА рддрд╛рдВрдЧ рдЙрдард╛рдпреЗ рдЪреЛрджреЗ рдкреВрд░рд╛ рджрд┐рд▓реНрд▓реА тЩия╕ПтЩия╕ПЁЯШЛЁЯССЁЯН╖ЁЯШВЁЯШВ",
    "Abe oy bengaliyo pr 1 shabd nhi sunuga me ruk tere papa ko call kru",
    "Teri maa ki chut mai deadlift mardunga",
    "Teri behen ko aeroplane mai betha ke chodunga",
    "Teri maa ko satellite pe chodu space mai new experience ЁЯдгЁЯдгЁЯдгЁЯдгЁЯММЁЯММЁЯММЁЯММЁЯММЁЯММ",
    "Teri maa ko asthetic way mai chodunga",
    "roj khaata mai burger teri maa q daily chudwane jaati hai Ghar ghar?",
    "рддреЗрд░реА рдорд╛рдБ рд░рдВрдЧрдмрд┐рд░рдВрдЧреА рд░рдВрдбреА тЭдя╕ПЁЯзбЁЯТЫЁЯй╖ЁЯТЪЁЯй╡ЁЯТЩЁЯТЬ",
    "Oye Teri maa ke bhosde mai pathhar daldunga",
    "Muh pe asa lund mrunga chud chudke pagal hojyga Oye Teri maa ke bhosde mai pathhar daldunga",
    "Teri maa ko chodkr chat se latka ke maar dalunga",
    "рддреЗрд░реА рдорд╛рдВ рдХреЛ рд╕реНрд╡рддрдВрддреНрд░рддрд╛ рджрд┐рд╡рд╕ рдореЗрдВ рдЭрдВрдбрд╛ рд▓рдЧрд╛рдХреЗ рдЪреЛрдж рд▓реВрдВрдЧрд╛ ok na",
    "oye mukke maru tere ma k mu prr",
    "teri ma rndy k mu pr lawda maru",
    "Reacted рд▓рдВрдб рд▓реЗрд▓реЗ to your message",
    "a guy gave me wise advice ignore kro jaise mai krta hu coz vo randike bachhe hai so imma apply that on you.",
    "Badle ki aag mein teri maa iss kadar joojh gayi Khaake mirch ka pakoda mera lund choos gayi",
    "Ary...salЁЯШВЁЯШВЁЯШВ huahh betichodke  ЁЯл╡ЁЯШП thare pichwadeЁЯНС mese ЁЯТи nikal jayegoЁЯдгЁЯШнkati baham parle o beta ЁЯШВЁЯШЖ",
    "Beta aaise chudega ya fir waise??Teri maa chтИЪde rafta rafta ya fir slowly slowly?"
 ]
}

@dataclass
class SpamTarget:
    user_id: int
    chat_id: int
    count: int
    active: bool
    reply_spam: bool = False

@dataclass
class RaidTarget:
    user_id: int
    chat_id: int
    active: bool

class SpamBot:
    def __init__(self, api_id: str, api_hash: str, owner_id: int):
        self.client = TelegramClient('session_name', api_id, api_hash)
        self.owner_id = owner_id
        self.spam_targets: Dict[int, SpamTarget] = {}
        self.raid_targets: Dict[int, RaidTarget] = {}
        self.spam_tasks: Dict[int, asyncio.Task] = {}

    async def send_spam(self, chat_id: int, user_id: int, count: int):
        try:
            user = await self.client.get_entity(user_id)
            username = f"@{user.username}" if user.username else f"User {user_id}"
            for _ in range(count):
                message = random.choice(SPAM_MESSAGES['hindi'])
                await self.client.send_message(chat_id, f"{username} {message}", reply_to=user_id)
                await asyncio.sleep(random.uniform(0.5, 1.5))
        except Exception as e:
            print(f"Error in send_spam: {str(e)}")

    async def raid_spam(self, user_id: int, chat_id: int):
        try:
            user = await self.client.get_entity(user_id)
            username = f"@{user.username}" if user.username else f"User {user_id}"
            while self.raid_targets.get(user_id, RaidTarget(user_id, chat_id, False)).active:
                message = random.choice(SPAM_MESSAGES['hindi'])
                await self.client.send_message(chat_id, f"{username} {message}")
                await asyncio.sleep(random.uniform(2, 3))
        except Exception as e:
            print(f"Error in raid_spam: {str(e)}")

    async def handle_message(self, event):
        if event.sender_id != self.owner_id:
            return

        text = event.message.text.strip()
        chat_id = event.chat_id
        reply_msg = await event.get_reply_message()
        user_id = reply_msg.sender_id if reply_msg else None

        try:
            await event.delete()
        except:
            pass

        if text == ".help":
            help_text = """ЁЯУЪ **Available Commands:**

ЁЯФ╣ **.spam <number>** - Spam random messages <number> times in current chat.
ЁЯФ╣ **.spam <number>** (reply to user) - Spam <number> times replying to the user.
ЁЯФ╣ **.rspam** (reply to user) - Auto-spam reply when the user sends a message or mentions you in the same chat.
ЁЯФ╣ **.slist** - List all active spam targets.
ЁЯФ╣ **.soff <username or ID>** (or reply to user) - Stop spamming a specific user.
ЁЯФ╣ **.offg** - Stop all active spam and raid tasks.
ЁЯФ╣ **.chudab <username or ID>** (or reply to user) - Start continuous raid spam on a user every 2-3 seconds.
ЁЯФ╣ **.roff <username or ID>** (or reply to user) - Stop raid spam for a specific user.
ЁЯФ╣ **.info** (reply to user) - Get user info (ID, username, name)."""
            await event.respond(help_text)
            return

        elif text.startswith(".spam"):
            parts = text.split()
            if len(parts) < 2 and not reply_msg:
                await event.respond("тЭМ Usage: .spam <number> or reply to a user with .spam <number>")
                return

            try:
                count = int(parts[1]) if len(parts) > 1 else 10
                if count <= 0:
                    raise ValueError
            except ValueError:
                await event.respond("тЭМ Invalid number for spam count")
                return

            if reply_msg:
                user_id = reply_msg.sender_id
                self.spam_targets[user_id] = SpamTarget(user_id, chat_id, count, True)
                await event.respond(f"тЬЕ Spamming {count} messages to User {user_id}")
                await self.send_spam(chat_id, user_id, count)
                self.spam_targets[user_id].active = False
            else:
                for _ in range(count):
                    message = random.choice(SPAM_MESSAGES['hindi'])
                    await self.client.send_message(chat_id, message)
                    await asyncio.sleep(random.uniform(0.5, 1.5))
                await event.respond(f"тЬЕ Spammed {count} messages in this chat")

        elif text == ".rspam" and reply_msg:
            user_id = reply_msg.sender_id
            self.spam_targets[user_id] = SpamTarget(user_id, chat_id, 0, True, reply_spam=True)
            await event.respond(f"тЬЕ Auto-reply spam enabled for User {user_id} in this chat")

        elif text == ".slist":
            if not self.spam_targets and not self.raid_targets:
                await event.respond("тЭМ No active spam or raid targets")
                return

            output = "ЁЯУЛ **Active Spam Targets:**\n\n"
            for user_id, target in self.spam_targets.items():
                if target.active:
                    output += f"ЁЯЖФ User {user_id} | Chat {target.chat_id} | {'Reply Spam' if target.reply_spam else f'Count: {target.count}'}\n"
            for user_id, target in self.raid_targets.items():
                if target.active:
                    output += f"ЁЯЖФ User {user_id} | Chat {target.chat_id} | Raid Spam\n"
            await event.respond(output)

        elif text.startswith(".soff"):
            parts = text.split()
            target_id = None
            if len(parts) > 1:
                target = parts[1].lstrip('@')
                try:
                    target_id = int(target)
                except ValueError:
                    try:
                        entity = await self.client.get_entity(target)
                        target_id = entity.id
                    except:
                        await event.respond("тЭМ Invalid username or ID")
                        return
            elif reply_msg:
                target_id = reply_msg.sender_id

            if target_id and target_id in self.spam_targets:
                self.spam_targets[target_id].active = False
                await event.respond(f"тЬЕ Spam stopped for User {target_id}")
            else:
                await event.respond("тЭМ No active spam for this user")

        elif text == ".offg":
            for user_id in self.spam_targets:
                self.spam_targets[user_id].active = False
            for user_id in self.raid_targets:
                self.raid_targets[user_id].active = False
                if user_id in self.spam_tasks:
                    self.spam_tasks[user_id].cancel()
                    del self.spam_tasks[user_id]
            await event.respond("тЬЕ All spam and raid tasks stopped")

        elif text.startswith(".chudab"):
            parts = text.split()
            target_id = None
            if len(parts) > 1:
                target = parts[1].lstrip('@')
                try:
                    target_id = int(target)
                except ValueError:
                    try:
                        entity = await self.client.get_entity(target)
                        target_id = entity.id
                    except:
                        await event.respond("тЭМ Invalid username or ID")
                        return
            elif reply_msg:
                target_id = reply_msg.sender_id

            if target_id:
                self.raid_targets[target_id] = RaidTarget(target_id, chat_id, True)
                self.spam_tasks[target_id] = asyncio.create_task(self.raid_spam(target_id, chat_id))
                await event.respond(f"тЬЕ Raid spam started for User {target_id}")
            else:
                await event.respond("тЭМ Usage: .chudab <username or ID> or reply to a user")

        elif text.startswith(".roff"):
            parts = text.split()
            target_id = None
            if len(parts) > 1:
                target = parts[1].lstrip('@')
                try:
                    target_id = int(target)
                except ValueError:
                    try:
                        entity = await self.client.get_entity(target)
                        target_id = entity.id
                    except:
                        await event.respond("тЭМ Invalid username or ID")
                        return
            elif reply_msg:
                target_id = reply_msg.sender_id

            if target_id and target_id in self.raid_targets:
                self.raid_targets[target_id].active = False
                if target_id in self.spam_tasks:
                    self.spam_tasks[target_id].cancel()
                    del self.spam_tasks[target_id]
                await event.respond(f"тЬЕ Raid spam stopped for User {target_id}")
            else:
                await event.respond("тЭМ No active raid for this user")

        elif text == ".info" and reply_msg:
            user = reply_msg.sender
            user_info = f"""ЁЯСд **User Info:**

ЁЯЖФ **ID:** `{user.id}`
ЁЯУЭ **Name:** {user.first_name or 'N/A'}
ЁЯСд **Username:** @{user.username if user.username else 'None'}
ЁЯФЧ **Link:** tg://user?id={user.id}"""
            await event.respond(user_info)

    async def handle_reply_spam(self, event):
        sender_id = event.sender_id
        chat_id = event.chat_id
        if sender_id in self.spam_targets and self.spam_targets[sender_id].active and self.spam_targets[sender_id].reply_spam and self.spam_targets[sender_id].chat_id == chat_id:
            user = await self.client.get_entity(sender_id)
            username = f"@{user.username}" if user.username else f"User {sender_id}"
            message = random.choice(SPAM_MESSAGES['hindi'])
            await self.client.send_message(chat_id, f"{username} {message}", reply_to=event.message.id)
            await asyncio.sleep(random.uniform(0.5, 1.5))

    async def start(self):
        print("Starting spam bot...")

        @self.client.on(events.NewMessage)
        async def message_handler(event):
            await self.handle_message(event)
            await self.handle_reply_spam(event)

        await self.client.start()
        print("тЬЕ Bot is running! Type .help to see commands")
        await self.client.run_until_disconnected()

async def main():
    api_id = input("Enter your Telegram API ID: ")
    api_hash = input("Enter your Telegram API Hash: ")
    owner_id = int(input("Enter your Telegram User ID: "))

    bot = SpamBot(api_id, api_hash, owner_id)
    await bot.start()

if __name__ == "__main__":
    asyncio.run(main())
